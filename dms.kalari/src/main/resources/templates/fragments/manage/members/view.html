<!-- fragments/add_node.html -->
<div th:fragment="content">
	<div class="modal-header">
		<h5 class="modal-title" id="addNodeModalLabel" th:text="${pageTitle}">Edit
			Node</h5>
		<button type="button" class="btn-close" data-bs-dismiss="modal"
			aria-label="Close"></button>
	</div>
	<!-- Modal Body -->
	<div class="modal-body">
		<div class="card-body">

			<div class="dms-card">
				<div class="dms-card-header">
					<i class="fas fa-user-circle me-2"></i>CANDIDATE PROFILE RECORD
				</div>
				<div class="dms-card-body">
					<div class="row align-items-center">
						<!-- Left Column - Name & Details -->
						<div class="col-md-8">
							<h2 class="mb-2"
								th:text="${user.userFname + ' ' + user.userLname}">Full
								Name</h2>
							<h5 class="mb-2 fw-bold" th:text="${user.designationName}">Association
								/ Role</h5>
							<p class="text-muted mb-3">
								<i class="fas fa-trophy me-1"></i> <span
									th:text="${user.userType}">User Type</span>
							</p>

							<div class="d-flex flex-wrap gap-2 mb-4">
								<span class="badge-dms"> <i class="fas fa-id-card me-1"></i>
									ID: <span th:text="${user.userId}">SP2023-00456</span>
								</span> <span class="badge bg-secondary"> <i
									class="fas fa-user-tag me-1"></i> <span
									th:text="${user.userMemberCategory}">Category</span>
								</span>
							</div>

							<div class="detail-row">
								<div class="detail-label">Date of Birth:</div>
								<div class="detail-value" th:text="${user.userDob}">--/--/----</div>
							</div>
							<div class="detail-row">
								<div class="detail-label">Gender:</div>
								<div class="detail-value" th:text="${user.gender}">--</div>
							</div>
							<div class="detail-row">
								<div class="detail-label">Aadhaar Number:</div>
								<div class="detail-value" th:text="${user.aadhaarNumber}">XXXX-XXXX-XXXX</div>
							</div>
						</div>

						<!-- Right Column - Photo -->
						<div class="col-md-4 text-center">
							<div class="profile-photo-container mx-auto mb-3">
								<img th:if="${user.photoFile != null}"
									th:src="@{/files/view/{id}(id=${user.photoFile})}"
									alt="Candidate Photo" class="profile-photo"> <img
									th:if="${user.photoFile == null}"
									src="/public/images/default-user.png" alt="Default Photo"
									class="profile-photo">
							</div>
						</div>
					</div>
				</div>
			</div>

			<!-- Document Preview Section -->
			<div class="dms-card mt-3">
				<div class="dms-card-header">
					<i class="fas fa-file-alt me-2"></i>UPLOADED DOCUMENTS
				</div>
				<div class="dms-card-body">
					<div class="row text-center">

						<!-- Photo File Preview -->
						<div class="col-md-4 mb-3" th:if="${user.photoFile != null}">
							<div class="preview-box mx-auto lightbox-trigger"
								th:attr="data-imgurl=@{/files/view/{id}(id=${user.photoFile})}"
								th:style="'background-image:url(/files/view/' + ${user.photoFile} + ');'">
							</div>
							<p class="mt-2 fw-bold">Photo</p>
						</div>

						<!-- ID Proof Preview -->
						<div class="col-md-4 mb-3" th:if="${user.idFile != null}">
							<div class="preview-box mx-auto lightbox-trigger"
								th:attr="data-imgurl=@{/files/view/{id}(id=${user.idFile})}"
								th:style="'background-image:url(/files/view/' + ${user.idFile} + ');'">
							</div>
							<p class="mt-2 fw-bold">ID Proof</p>
						</div>

						<!-- Age Proof Preview -->
						<div class="col-md-4 mb-3" th:if="${user.ageproofFile != null}">
							<div class="preview-box mx-auto lightbox-trigger"
								th:attr="data-imgurl=@{/files/view/{id}(id=${user.ageproofFile})}"
								th:style="'background-image:url(/files/view/' + ${user.ageproofFile} + ');'">
							</div>
							<p class="mt-2 fw-bold">Age Proof</p>
						</div>

					</div>
				</div>
			</div>










			<div class="row">
				<!-- Personal Information Column -->
				<div class="col-lg-6">
					<div class="dms-card">
						<div class="dms-card-header">
							<i class="fas fa-info-circle me-2"></i>PERSONAL INFORMATION
						</div>
						<div class="dms-card-body">
							<div class="info-group">
								<div class="info-label">FATHER'S NAME</div>
								<div class="info-value" th:text="${user.fatherName}">Father
									Name</div>
							</div>
							<div class="info-group">
								<div class="info-label">MOTHER'S NAME</div>
								<div class="info-value" th:text="${user.motherName}">Mother
									Name</div>
							</div>
							<div class="info-group">
								<div class="info-label">ADDRESS</div>
								<div class="info-value">
									<span th:text="${user.addressLine1}"></span><br> <span
										th:text="${user.addressLine2}"></span><br> <span
										th:text="${user.addressLine3}"></span>, <span
										th:text="${user.addressState}"></span> - <span
										th:text="${user.addressPin}"></span>
								</div>
							</div>
							<div class="info-group">
								<div class="info-label">STATE & NATIONALITY</div>
								<div class="info-value">
									<span th:text="${user.addressState}"></span>, <span
										th:text="${user.addressState}">Indian</span>
								</div>
							</div>
						</div>
					</div>
				</div>

				<!-- Contact & Status Column -->
				<div class="col-lg-6">
					<div class="dms-card">
						<div class="dms-card-header">
							<i class="fas fa-address-card me-2"></i>CONTACT & STATUS
						</div>
						<div class="dms-card-body">
							<div class="info-group">
								<div class="info-label">PARTICIPANT STATUS</div>
								<div class="info-value">
									<span th:if="${user.userStatus == 1}"
										class="status-badge status-student"> <i
										class="fas fa-check-circle me-1"></i> ACTIVE
									</span> <span th:if="${user.userStatus == 2}"
										class="status-badge status-inactive"> <i
										class="fas fa-times-circle me-1"></i> INACTIVE
									</span>
								</div>
							</div>
							<div class="info-group">
								<div class="info-label">MOBILE NUMBER</div>
								<div class="info-value">
									<i class="fas fa-phone me-2"></i> <span
										th:text="${user.mobileNumber}"></span>
								</div>
							</div>
							<div class="info-group">
								<div class="info-label">EMAIL ADDRESS</div>
								<div class="info-value">
									<i class="fas fa-envelope me-2"></i> <span
										th:text="${user.userEmail}"></span>
								</div>
							</div>
							<div class="info-group">
								<div class="info-label">EMERGENCY CONTACT</div>
								<div class="info-value">
									<i class="fas fa-phone-alt me-2"></i> <span
										th:text="${user.emergencyContact}"></span>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>

			<div
				th:if="${#authorization.expression('hasAuthority(''PRIV_members_verify'')')}">
				<div
					th:if="${user.photoFile != null and user.idFile != null and user.ageproofFile != null and user.verificationStatus == 0}">
					<form id="verifyForm"
						th:action="@{'/members_verify/' + ${userIdMasked}}" method="post">
						<div class="form-check mt-3">
							<input class="form-check-input" type="checkbox" id="verifyCheck"
								name="verified"> <label class="form-check-label"
								for="verifyCheck"> I hereby confirm that I have verified
								the details of the participant(s) provided above, including the
								name, date of birth, gender, and Aadhaar number, and that all
								supporting documents are correct and valid. I accept full
								responsibility for any disputes, discrepancies, or
								irregularities arising now or in the future in connection with
								events, competitions, or issuance of certificates associated
								with the verified data. </label>
						</div>
						<button type="button" class="btn btn-success btn-sm mt-2"
							id="verifyBtn" onclick="submitHtmlForm('verifyForm', 'modal')">
							Confirm Verification</button>
					</form>
				</div>
			</div>

		</div>
	</div>

</div>
<!-- Modal Footer -->
<div class="modal-footer">
	<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
</div>




<style>

/* Preview box */
.preview-box {
	width: 120px;
	height: 120px;
	background-size: cover;
	background-position: center;
	border-radius: 10px;
	cursor: pointer;
	transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.preview-box:hover {
	transform: scale(1.05);
	box-shadow: 0 4px 12px rgba(0, 0, 0, 0.25);
}

/* Lightbox modal */
.lightbox-modal {
	z-index: 1060 !important; /* above parent modal */
	text-align: center;
}

/* Backdrop */
.lightbox-modal .modal-backdrop {
	z-index: 1059 !important;
}

/* Modal dialog shrinks to image */
.lightbox-modal .modal-dialog {
	display: inline-block;
	max-width: 90vw;
	margin: 1.5rem auto;
	vertical-align: middle;
}

/* Modal content */
.lightbox-modal .modal-content {
	background: transparent !important;
	border: none !important;
	padding: 0;
	display: inline-block;
	position: relative;
}

/* Image container */
.lightbox-modal .lightbox-img-container {
	position: relative;
	display: inline-block;
}

/* Image */
.lightbox-modal .lightbox-img {
	display: block;
	max-width: 90vw;
	max-height: 80vh;
	object-fit: contain;
	border-radius: 8px;
	box-shadow: 0 5px 25px rgba(0, 0, 0, 0.5);
}

/* Floating close button */
.lightbox-modal .lightbox-close {
	position: absolute;
	top: -10px;
	right: -10px;
	width: 35px;
	height: 35px;
	background: rgba(0, 0, 0, 0.7);
	border-radius: 50%;
	border: 2px solid white;
	display: flex;
	align-items: center;
	justify-content: center;
	cursor: pointer;
	z-index: 10;
	opacity: 0.9;
	transition: opacity 0.2s ease;
}

/* White "X" for close button */
.lightbox-modal .lightbox-close::before, .lightbox-modal .lightbox-close::after
	{
	content: '';
	position: absolute;
	width: 16px;
	height: 2px;
	background-color: white;
}

.lightbox-modal .lightbox-close::before {
	transform: rotate(45deg);
}

.lightbox-modal .lightbox-close::after {
	transform: rotate(-45deg);
}

.lightbox-modal .lightbox-close:hover {
	opacity: 1;
}

.modal-dialog {
	max-width: 60% !important;
}

@media ( max-width : 768px) {
	.modal-dialog {
		max-width: 100% !important;
		margin: 10px;
	}
	.preview-box {
		width: 120px;
		height: 120px;
	}
}
</style>

<script>
	// Simple lightbox implementation
	document.addEventListener('click', function(e) {
		var trigger = e.target.closest('.lightbox-trigger');
		if (!trigger)
			return;

		e.preventDefault();

		var imgUrl = trigger.getAttribute('data-imgurl');
		if (!imgUrl)
			return;

		var lightboxModalEl = document.getElementById('imageLightbox');
		var lightboxImage = document.getElementById('lightboxImage');

		// Set image src
		lightboxImage.src = imgUrl;

		// Show modal
		var lightboxModal = new bootstrap.Modal(lightboxModalEl, {
			backdrop : 'static'
		});
		lightboxModal.show();

		// Clear image when closed
		lightboxModalEl.addEventListener('hidden.bs.modal', function() {
			lightboxImage.src = '';

			var backdrop = document.querySelector('.modal-backdrop');
			if (backdrop)
				backdrop.remove();

		}, {
			once : true
		});
	});
</script>







<!-- Championship Participation Section 
        <h3 class="section-title">
            <i class="fas fa-trophy me-2"></i> ACHIVEMENTS
        </h3>
        
        <div class="table-responsive">
            <table class="table table-dms">
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Event Name</th>
                        <th>Year</th>
                        <th>Location</th>
                        <th>Category</th>
                        <th>Result</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>1</td>
                        <td>National Athletics Championship</td>
                        <td>2022</td>
                        <td>New Delhi</td>
                        <td>Senior</td>
                        <td>
                            <span class="medal-gold">
                                <i class="fas fa-medal me-1"></i> 1st (Gold)
                            </span>
                        </td>
                        <td>
                            <button class="btn btn-sm btn-outline-primary">
                                <i class="fas fa-file-alt"></i> View
                            </button>
                        </td>
                    </tr>
                    <tr>
                        <td>2</td>
                        <td>State Level Swimming Competition</td>
                        <td>2021</td>
                        <td>Bangalore</td>
                        <td>Senior</td>
                        <td>
                            <span class="medal-silver">
                                <i class="fas fa-medal me-1"></i> 2nd (Silver)
                            </span>
                        </td>
                        <td>
                            <button class="btn btn-sm btn-outline-primary">
                                <i class="fas fa-file-alt"></i> View
                            </button>
                        </td>
                    </tr>
                    <tr>
                        <td>3</td>
                        <td>Inter-University Sports Meet</td>
                        <td>2020</td>
                        <td>Mumbai</td>
                        <td>Junior</td>
                        <td>
                            <span class="medal-bronze">
                                <i class="fas fa-medal me-1"></i> 3rd (Bronze)
                            </span>
                        </td>
                        <td>
                            <button class="btn btn-sm btn-outline-primary">
                                <i class="fas fa-file-alt"></i> View
                            </button>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>-->
