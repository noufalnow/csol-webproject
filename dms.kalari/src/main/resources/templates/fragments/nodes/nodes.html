
<!-- fragments/node_list.html -->
<div th:fragment="content">


	<div class="container mt-1 mb-3 px-0">
		<div class="row align-items-center">

			<!-- Left: Node Name (4 cols) -->
			<div class="col-12 col-md-5 mb-2 mb-md-0">

					
			<div class="d-flex align-items-center justify-content-between">
			    <h4 class="mb-0 px-3 py-2 rounded d-flex align-items-center justify-content-between"
			        style="background-color: var(--bs-gray-200); font-size: 1.1rem; font-weight: 600; color: var(--bs-dark); width: 100%;">
			        
					<a th:onclick="'loadContent(\'/branch_nodeview/' + ${parentId} + '\', \'modal\')'"
					   class="text-decoration-none cursor-pointer" style="cursor: pointer;">
					    <span th:text="${nodeName}">Affiliation</span>
					</a>

			        
			        <a class="btn btn-sm btn-outline-primary px-1 py-1"
			           th:if="${(!isChild and #authorization.expression('hasAuthority(''PRIV_branch_nodeedit'')')) 
			                    or (isChild and #authorization.expression('hasAuthority(''PRIV_branch_nodeedit_child'')'))}"
			           th:onclick="'loadContent(\'/branch_nodeedit/' +${parentId}+ '\', \'modal\')'">
			            <i class="fas fa-edit"></i>
			        </a>
			    </h4>
			</div>


					
				
			</div>

			<!-- Right: Radio Buttons (8 cols) -->
			<div class="col-12 col-md-7">
				<div class="row" style="padding-left: .75rem;">
					<input type="hidden" id="tempSelectedId" name="tempSelectedId"
						th:value="${parentId}" />

					<div
						th:if="${nodeType != 'KALARI' and #authorization.expression('hasAuthority(''PRIV_branch_nodelist'')')}"
						class="col-6 col-md-3 mb-2 mb-md-0">
						<div class="form-check">
							<input class="form-check-input" type="radio" name="choice"
								id="option1" value="nodes" checked
								th:onclick="|loadContent('branch_nodelist/${parentId}', '#users_target'); clearTreeForm()|">
							<label class="form-check-label" for="option1"
								style="cursor: pointer;">Affiliations</label>
						</div>
					</div>

					<div
						th:if="${#authorization.expression('hasAuthority(''PRIV_officials_bynode'')')}"
						class="col-6 col-md-3 mb-2 mb-md-0">
						<div class="form-check">
							<input class="form-check-input" type="radio" name="choice"
								id="option2" value="officials"
								th:onclick="|loadContent('officials_bynode/${parentId}', '#users_target'); clearTreeForm()|">
							<label class="form-check-label" for="option2"
								style="cursor: pointer;">Officials</label>
						</div>
					</div>

					<div
						th:if="${nodeType == 'KALARI' and #authorization.expression('hasAuthority(''PRIV_members_bynode'')')}"
						class="col-6 col-md-3 mb-2 mb-md-0">
						<div class="form-check">
							<input class="form-check-input" type="radio" name="choice"
								id="option3" value="members"
								th:onclick="|loadContent('members_bynode/${parentId}', '#users_target'); clearTreeForm()|">
							<label class="form-check-label" for="option3"
								style="cursor: pointer;">Participants</label>
						</div>
					</div>

					<div
						th:if="${#authorization.expression('hasAuthority(''PRIV_champ_eventbynode'')')}"
						class="col-6 col-md-3 mb-2 mb-md-0">
						<div class="form-check">
							<input class="form-check-input" type="radio" name="choice"
								id="option4" value="events"
								th:onclick="|loadContent('champ_eventbynode/${parentId}', '#users_target'); clearTreeForm()|">
							<label class="form-check-label" for="option4"
								style="cursor: pointer;">Events</label>
						</div>
					</div>

					<div
						th:if="${nodeType == 'KALARI' and #authorization.expression('hasAuthority(''PRIV_champ_eventall'')')}"
						class="col-6 col-md-3 mb-2 mb-md-0">
						<div class="form-check">
							<input class="form-check-input" type="radio" name="choice"
								id="option5" value="eventsall"
								th:onclick="|loadContent('champ_eventall/${parentId}', '#users_target'); clearTreeForm()|">
							<label class="form-check-label" for="option5"
								style="cursor: pointer;">All Events</label>
						</div>
					</div>

				</div>
			</div>
		</div>
	</div>






	<div class="d-flex justify-content-between align-items-center mb-3">
		<h4 class="mb-0">
			<span th:text="${nextNodeType}"></span> AFFILIATION [<span
				th:text="${#lists.size(nodeList)}"></span>]
		</h4>

		<!-- Search Form 
    <form id="search-form" method="GET" class="mb-3 d-flex">
        <input type="text" name="search" class="form-control me-2" placeholder="Search..." th:value="${search}">
        <button type="submit" class="btn btn-primary">Search</button>
    </form>-->

		<a
			th:if="${(!isChild and #authorization.expression('hasAuthority(''PRIV_branch_nodeadd'')')) 
           or (isChild and #authorization.expression('hasAuthority(''PRIV_branch_nodeadd_child'')'))}"
			class="btn btn-sm btn-outline-primary me-1 ajax-link"
			href="javascript:void(0);"
			th:onclick="'loadContent(\'' + @{'/branch_nodeadd/' + ${parentId}} + '\', \'modal\')'">
			<i class="fas fa-plus"></i> Add New Affiliation
		</a>



	</div>

	<!-- Node Table -->
	<div class="table-responsive">
		<table
			class="table table-striped table-hover table-bordered align-middle">
			<thead class="table-light">
				<tr>
					<th scope="col"><a href="#" class="" data-field="nodeId">#</a>
					</th>
					<th scope="col"><a href="#" class="" data-field="nodeName">Name</a>
					</th>
					<th scope="col">Actions</th>
				</tr>
			</thead>
			<tbody>
				<tr th:each="node, iterStat : ${nodeList}">
					<th scope="row" th:text="${iterStat.count}">1</th>
					<td th:text="${node.nodeName}">Node Name</td>
					<td>
						<div
							class="d-flex flex-column flex-lg-row gap-2 align-items-center">
							<a
								class="btn btn-sm btn-outline-primary d-flex align-items-center justify-content-center px-2 py-1"
								th:onclick="'loadContent(\'/branch_nodeview/' + ${xorMaskHelper.mask(node.nodeId)} + '\', \'modal\')'">
								<i class="fas fa-eye"
								th:classappend="${node.nodeStatus == 1} ? ' text-success' : ' text-danger'"></i>
								<span class="ms-1">View</span>
							</a>
							<a
								class="btn btn-sm btn-outline-primary d-flex align-items-center justify-content-center px-2 py-1"
								th:if="${(!isChild and #authorization.expression('hasAuthority(''PRIV_branch_nodeedit'')')) 
                				or (isChild and #authorization.expression('hasAuthority(''PRIV_branch_nodeedit_child'')'))}"
								th:onclick="'loadContent(\'/branch_nodeedit/' + ${xorMaskHelper.mask(node.nodeId)} + '\', \'modal\')'">
								<i class="fas fa-edit"></i> <span class="ms-1">Edit</span>
							</a>
						</div>
					</td>
				</tr>
				<!-- Empty state -->
				<tr th:if="${nodeList == null or #lists.isEmpty(nodeList)}">
					<td colspan="5" class="text-center">No nodes found</td>
				</tr>
			</tbody>

		</table>
	</div>

</div>
